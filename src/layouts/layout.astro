---
import Nav from "@/components/nav.astro";
import "@/styles/global.css";
import ogImage from "@/assets/og.webp";
import { getImage } from "astro:assets";

const ogImageData = await getImage({ src: ogImage, width: 1200, height: 630 });
const siteUrl = Astro.site?.href || Astro.url.origin;
const pageUrl = new URL(Astro.url.pathname, siteUrl).href;
const ogImageUrl = new URL(ogImageData.src, siteUrl).href;
const fullTitle = `Doppelganger - ${Astro.props.title}`;
const description =
    Astro.props.description ||
    "The modern enterprise is a vast, unspoken sea of intuitionâ€”a collective consciousness fractured across a thousand minds, lost in the transience of the workday.";
---

<html lang="en">
    <head>
        <meta charset="utf-8" />
        <link rel="icon" type="image/svg+xml" href="/logo.webp" />
        <link rel="icon" href="/logo.webp" />
        <meta name="viewport" content="width=device-width" />
        <meta name="generator" content={Astro.generator} />
        <title>{fullTitle}</title>

        <!-- Primary Meta Tags -->
        <meta name="title" content={fullTitle} />
        <meta name="description" content={description} />

        <!-- Open Graph / Facebook -->
        <meta property="og:type" content="website" />
        <meta property="og:url" content={pageUrl} />
        <meta property="og:title" content={fullTitle} />
        <meta property="og:description" content={description} />
        <meta property="og:image" content={ogImageUrl} />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="630" />

        <!-- Twitter -->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:url" content={pageUrl} />
        <meta name="twitter:title" content={fullTitle} />
        <meta name="twitter:description" content={description} />
        <meta name="twitter:image" content={ogImageUrl} />
    </head>
    <body>
        <div
            class="flex flex-col items-center justify-center container max-w-4xl mx-auto px-4 md:px-0"
        >
            <Nav />
            <slot />
        </div>
    </body>
</html>
